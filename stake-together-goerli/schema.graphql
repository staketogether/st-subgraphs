type StakeTogether @entity {
  id: ID!

  accounts: [Account!]! @derivedFrom(field: "st")
  communities: [Community!]! @derivedFrom(field: "st")
  delegations: [Delegation!]! @derivedFrom(field: "st")

  ethBalance: BigInt!
  clBalance: BigInt!
  trBalance: BigInt!
  withdrawalsBalance: BigInt!

  totalShares: BigInt!
  totalDelegatedShares: BigInt!

  stakeTogetherFeeRecipient: Bytes
  operatorFeeRecipient: Bytes

  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}

type Account @entity {
  id: ID!
  st: StakeTogether!

  address: Bytes!
  shares: BigInt!
  amount: BigInt!
  delegates: [Delegation!]! @derivedFrom(field: "delegator")

  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}

type Community @entity {
  id: ID!
  st: StakeTogether!

  address: Bytes!
  active: Boolean!
  delegatedShares: BigInt!
  delegatedAmount: BigInt!
  delegates: [Delegation!]! @derivedFrom(field: "delegated")

  rewardsShares: BigInt!
  rewardsAmount: BigInt!

  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}

type Delegation @entity {
  id: ID!
  st: StakeTogether!

  delegator: Account!
  delegated: Community!

  shares: BigInt!
  amount: BigInt!

  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}
